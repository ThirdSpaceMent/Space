@model prjWebSpaceMent.Models.Rates

@{
    ViewBag.Title = "EditRating";
    Layout = "~/Views/Shared/_LayoutMember.cshtml";
}

<section id="subspaces">
    <div class="container wow fadeInUp">
        <div class="section-header p-5">
            <h2>改變心意了嗎？</h2>
            <p>點擊下方按鈕返回！</p>
        </div>

        <form method="POST" action="#">
            <div class="form-row justify-content-center">
                <div class="col-auto">
                    <a href="/Spaces/Spaces_Detail" class="joinbutton-a">
                        <span class="joinbutton-a-span"></span>
                        <span class="joinbutton-a-span"></span>
                        <span class="joinbutton-a-span"></span>
                        <span class="joinbutton-a-span"></span>
                        返回
                    </a>
                </div>
            </div>
        </form>

    </div>
</section>


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div>
        @*<h4>Rates</h4>
        <hr />*@
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.rNumber)

        <div>
            @*@Html.LabelFor(model => model.rRate, htmlAttributes: new { @class = "control-label col-md-2" })*@
            @*<div class="col-md-10">
                @Html.EditorFor(model => model.rRate, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.rRate, "", new { @class = "text-danger" })
            </div>*@
            <div class="stars mt-2">
                @{
                    int m = Convert.ToInt32(Model.rRate);
                    for (int i = 1; i <= m; i++)
                    {
                        <i class="fa fa-star checked"></i>
                    }
                    for (int i = m; i < 5; i++)
                    {
                        <i class="fa fa-star-o"></i>
                    }
                }
            </div>
            <div>
                評論: @Model.rComment
            </div>
            <div>
                評價時間: @Model.rCreated_at.ToString("yyyy/MM/dd HH:mm")
            </div>
        </div>
        <div class="justify-content-center text-center mt-3 mb-3">

            @using (Html.BeginForm("EditRating", "Rating", FormMethod.Post, new { onsubmit = "return VerifyRating()" }))
            {
                <h4>請輸入評價 :</h4>
                <div class="stars mb-3" onmouseout="CRateSelected()">
                    <i id="i1" onmouseout="CRateOut(1)" onmouseover="CRateOver(1)" onclick="CRateClick(1)" class="fa fa-star-o"></i>
                    <i id="i2" onmouseout="CRateOut(2)" onmouseover="CRateOver(2)" onclick="CRateClick(2)" class="fa fa-star-o"></i>
                    <i id="i3" onmouseout="CRateOut(3)" onmouseover="CRateOver(3)" onclick="CRateClick(3)" class="fa fa-star-o"></i>
                    <i id="i4" onmouseout="CRateOut(4)" onmouseover="CRateOver(4)" onclick="CRateClick(4)" class="fa fa-star-o"></i>
                    <i id="i5" onmouseout="CRateOut(5)" onmouseover="CRateOver(5)" onclick="CRateClick(5)" class="fa fa-star-o"></i>
                </div>

                <textarea rows="6" cols="50" name="rComment" id="txtrComment" placeholder="輸入修改內容" required></textarea>
                <div>
                    <input type="hidden" name="rating" id="lblRating" value="0" />
                </div>
                <div>
                    <input type="hidden" name="sNumber" id="lblRating" value="@ViewBag.sNumber" />
                </div>
                <div>
                    <input type="submit" class="btn btn-primary active" name="SaveRating" value="送出" />@ViewBag.Message
                </div>
            }
        </div>

        @*<div class="form-group">
                @Html.LabelFor(model => model.rComment, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.EditorFor(model => model.rComment, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.rComment, "", new { @class = "text-danger" })
                </div>
            </div>


            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Save" class="btn btn-default" />
                </div>
            </div>*@
    </div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>
<script type="text/javascript">
    function CRateOut(rating) {
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star-o');
        }
    }
    function CRateOver(rating) {
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star checked');
        }
    }
    function CRateClick(rating) {
        $("#lblRating").val(rating);
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star checked');
        }
        for (var i = rating + 1; i <= 5; i++) {
            $("#i" + i).attr('class', 'fa fa-star-o');
        }
    }
    function CRateSelected() {
        var rating = $("#lblRating").val();
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star checked');
        }
    }
    function VerifyRating() {
        var rating = $("#lblRating").val();
        if (rating == "0") {
            alert("請選擇星數");
            return false;
        }
    }
</script>
<style>
    .checked {
        color: orange;
    }
</style>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
