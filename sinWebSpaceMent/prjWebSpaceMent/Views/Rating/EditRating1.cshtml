@model IEnumerable<prjWebSpaceMent.Models.Rates>
@{
    ViewBag.Title = "EditRating";
    Layout = "~/Views/Shared/_LayoutMember.cshtml";
}

<section id="subspaces">
    <div class="container wow fadeInUp">
        <div class="section-header p-5">
            <h2>改變心意了嗎？</h2>
            <p>點擊下方按鈕返回！</p>
        </div>

        <form method="POST" action="#">
            <div class="form-row justify-content-center">
                <div class="col-auto">
                    <a href="/Spaces/Spaces_Detail" class="joinbutton-a">
                        <span class="joinbutton-a-span"></span>
                        <span class="joinbutton-a-span"></span>
                        <span class="joinbutton-a-span"></span>
                        <span class="joinbutton-a-span"></span>
                        返回
                    </a>
                </div>
            </div>
        </form>

    </div>
</section>
<div class="col-6">
    <table class="mx-auto mb-3 border-bottom" style="width:500px;">
        <tr>
            <td class="p-2" style="font-size:25px;font-weight:500;">
                會員: @Model.FK_Rate_to_Member
                <div class="stars mt-2">
                    @{
                        int m = Convert.ToInt32(Model.rRate);
                        //int n = Convert.ToInt32(Model.rRate*10) - m*10;

                        for (int i = 1; i <= m; i++)
                        {
                            <i class="fa fa-star checked"></i>
                        }
                        @*if (n > 3)
                            {
                                <i class="fa fa-star-half-full checked"></i>
                            }*@
                        for (int i = m; i < 5; i++)
                        {
                            <i class="fa fa-star-o"></i>
                        }
                    }
                </div>
            </td>
        </tr>
        <tr>
            <td class="p-2" style="font-size:25px;font-weight:500;">
                評論: @Model.rComment
            </td>
        </tr>
        <tr>
            <td class="p-2" style="font-size:16px;font-weight:500;">
                評價時間: @Model.rCreated_at.ToString("yyyy/MM/dd HH:mm")
            </td>
        </tr>
    </table>
</div>
<div class="d-flex justify-content-center text-center mt-3 mb-3">

    @using (Html.BeginForm("EditRating", "Rating", FormMethod.Post, new { onsubmit = "return VerifyRating()" }))
    {
        <h4>請輸入評價 :</h4>
        <div class="stars mb-3" onmouseout="CRateSelected()">
            <i id="i1" onmouseout="CRateOut(1)" onmouseover="CRateOver(1)" onclick="CRateClick(1)" class="fa fa-star-o"></i>
            <i id="i2" onmouseout="CRateOut(2)" onmouseover="CRateOver(2)" onclick="CRateClick(2)" class="fa fa-star-o"></i>
            <i id="i3" onmouseout="CRateOut(3)" onmouseover="CRateOver(3)" onclick="CRateClick(3)" class="fa fa-star-o"></i>
            <i id="i4" onmouseout="CRateOut(4)" onmouseover="CRateOver(4)" onclick="CRateClick(4)" class="fa fa-star-o"></i>
            <i id="i5" onmouseout="CRateOut(5)" onmouseover="CRateOver(5)" onclick="CRateClick(5)" class="fa fa-star-o"></i>
        </div>

        <textarea rows="6" cols="50" name="rComment" id="txtrComment" placeholder="請對場地給一些建議吧..." required></textarea>
        <div>
            <input type="hidden" name="rating" id="lblRating" value="0" />
        </div>
        <div>
            <input type="hidden" name="sNumber" id="lblRating" value="@ViewBag.sNumber" />
        </div>
        <div>
            <input type="submit" class="btn btn-primary active" name="SaveRating" value="送出" />@ViewBag.Message
        </div>
    }
</div>

<script type="text/javascript">
    function CRateOut(rating) {
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star-o');
        }
    }
    function CRateOver(rating) {
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star checked');
        }
    }
    function CRateClick(rating) {
        $("#lblRating").val(rating);
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star checked');
        }
        for (var i = rating + 1; i <= 5; i++) {
            $("#i" + i).attr('class', 'fa fa-star-o');
        }
    }
    function CRateSelected() {
        var rating = $("#lblRating").val();
        for (var i = 0; i <= rating; i++) {
            $("#i" + i).attr('class', 'fa fa-star checked');
        }
    }
    function VerifyRating() {
        var rating = $("#lblRating").val();
        if (rating == "0") {
            alert("請選擇星數");
            return false;
        }
    }
</script>
<style>
    .checked {
        color: orange;
    }
</style>